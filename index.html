<!DOCTYPE html>  
<html lang="de">  
<head>  
  <meta charset="UTF-8">  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">  
  <title>Professor Kelvinius Escape Room</title>  
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>  
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>  
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>  
  <script src="https://cdn.tailwindcss.com"></script>  
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>  
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî¨</text></svg>">  
</head>  
<body>  
  <div id="root"></div>  

  <script type="text/babel">  
    const { useState, useEffect } = React;  
    
    // Icons aus Lucide  
    const {   
      CheckCircle, XCircle, Lock, Unlock, HelpCircle, Lightbulb,   
      ArrowRight, Thermometer, AlertTriangle, PenTool, Timer, Play, Pause, RefreshCw  
    } = lucide;  

    function EscapeRoomValidator() {  
      const [activeRiddle, setActiveRiddle] = useState(1);  
      const [inputCode, setInputCode] = useState("");  
      const [resultMessage, setResultMessage] = useState("");  
      const [isSuccess, setIsSuccess] = useState(false);  
      const [showHint, setShowHint] = useState(false);  
      const [showCongrats, setShowCongrats] = useState(false);  
      const [hintTimePenalty, setHintTimePenalty] = useState(0);  
      const [remainingTime, setRemainingTime] = useState(90 * 60); // 90 minutes in seconds  
      const [isTimerRunning, setIsTimerRunning] = useState(false);  

      // All the riddle solutions  
      const solutions = {  
        1: { code: "3414", name: "Temperaturumrechnung", hint: "Denkt an den menschlichen K√∂rper, K√ºhlschrank, Siedepunkt und den Punkt, an dem ¬∞F und ¬∞C √ºbereinstimmen." },  
        2: { code: "75239", name: "Thermometer", hint: "Die Anfangsbuchstaben der Thermometertypen ergeben ein wichtiges Wort. Beachtet die historische Reihenfolge." },  
        3: { code: "SV3", name: "Aggregatzust√§nde", hint: "S und V stehen f√ºr Zustands√§nderungen, bei denen Energie aufgenommen wird. Die Zahl steht f√ºr Prozesse mit Energieabgabe." },  
        4: { code: "8592", name: "W√§rmeausdehnung", hint: "Ordnet die Materialien nach ihren Ausdehnungskoeffizienten. Berechnet die L√§ngen√§nderung mit ŒîL = L‚ÇÄ √ó Œ± √ó ŒîT." },  
        5: { code: "298KALT", name: "Finale", hint: "Rechnet 122¬∞F in Celsius um, zieht 25¬∞C ab und konvertiert ins absolute Temperaturma√ü." }  
      };  

      // Format time as MM:SS  
      const formatTime = (timeInSeconds) => {  
        const minutes = Math.floor(timeInSeconds / 60);  
        const seconds = timeInSeconds % 60;  
        return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;  
      };  

      // Timer effect  
      useEffect(() => {  
        let interval;  
        if (isTimerRunning && remainingTime > 0) {  
          interval = setInterval(() => {  
            setRemainingTime((prevTime) => prevTime - 1);  
          }, 1000);  
        } else if (remainingTime <= 0) {  
          setIsTimerRunning(false);  
          alert("Die Zeit ist abgelaufen! Das Labor des Professors wurde zerst√∂rt.");  
        }  
        return () => clearInterval(interval);  
      }, [isTimerRunning, remainingTime]);  

      // Handle start timer  
      const handleStartTimer = () => {  
        setIsTimerRunning(true);  
      };  

      // Handle pause timer  
      const handlePauseTimer = () => {  
        setIsTimerRunning(false);  
      };  

      // Reset timer  
      const handleResetTimer = () => {  
        setIsTimerRunning(false);  
        setRemainingTime(90 * 60);  
        setHintTimePenalty(0);  
      };  

      // Check if the code is correct  
      const validateCode = () => {  
        const solution = solutions[activeRiddle];  
        
        // Convert both to uppercase for case-insensitive comparison and trim whitespace  
        const normalizedInput = inputCode.trim().toUpperCase();  
        const normalizedSolution = solution.code.trim().toUpperCase();  
        
        if (normalizedInput === normalizedSolution) {  
          setIsSuccess(true);  
          setResultMessage(`Richtig! Der Code f√ºr R√§tsel ${activeRiddle} (${solution.name}) ist korrekt.`);  
          
          // If this is the last riddle, show congratulations  
          if (activeRiddle === Object.keys(solutions).length) {  
            setShowCongrats(true);  
          }  
        } else {  
          setIsSuccess(false);  
          setResultMessage(`Falscher Code f√ºr R√§tsel ${activeRiddle}. Versuche es noch einmal!`);  
        }  
      };  

      // Handle Next Riddle button  
      const handleNextRiddle = () => {  
        if (activeRiddle < Object.keys(solutions).length) {  
          setActiveRiddle(activeRiddle + 1);  
          setInputCode("");  
          setResultMessage("");  
          setIsSuccess(false);  
          setShowHint(false);  
        }  
      };  

      // Handle Previous Riddle button  
      const handlePreviousRiddle = () => {  
        if (activeRiddle > 1) {  
          setActiveRiddle(activeRiddle - 1);  
          setInputCode("");  
          setResultMessage("");  
          setIsSuccess(false);  
          setShowHint(false);  
        }  
      };  

      // Toggle hint visibility with time penalty  
      const toggleHint = () => {  
        if (!showHint) {  
          // Apply time penalty of 5 minutes when showing a hint  
          setHintTimePenalty(hintTimePenalty + 5 * 60);  
          setRemainingTime(prev => Math.max(0, prev - 5 * 60));  
        }  
        setShowHint(!showHint);  
      };  

      return (  
        <div className="min-h-screen bg-gradient-to-b from-[#f0f4f8] to-[#e1e9f0] p-6">  
          {/* Timer and controls */}  
          <div className="bg-white rounded-lg shadow-lg p-4 mb-6 max-w-5xl mx-auto">  
            <div className="flex flex-col sm:flex-row justify-between items-center mb-4">  
              <h2 className="text-xl font-semibold text-[#005b96] mb-2 sm:mb-0">  
                Professor Kelvinius' Labor  
              </h2>  
              <div className="flex items-center space-x-2">  
                <button  
                  onClick={handleStartTimer}  
                  disabled={isTimerRunning}  
                  className="px-4 py-2 bg-[#005b96] text-white rounded-md hover:bg-[#003b66] disabled:opacity-50 flex items-center"  
                >  
                  <Play size={16} className="mr-1" />  
                  Start  
                </button>  
                <button  
                  onClick={handlePauseTimer}  
                  disabled={!isTimerRunning}  
                  className="px-4 py-2 bg-[#6497b1] text-white rounded-md hover:bg-[#4477a1] disabled:opacity-50 flex items-center"  
                >  
                  <Pause size={16} className="mr-1" />  
                  Pause  
                </button>  
                <button  
                  onClick={handleResetTimer}  
                  className="px-4 py-2 bg-[#CC0000] text-white rounded-md hover:bg-[#aa0000] flex items-center"  
                >  
                  <RefreshCw size={16} className="mr-1" />  
                  Reset  
                </button>  
              </div>  
            </div>  
            
            <div className="flex flex-col sm:flex-row justify-between items-center">  
              <div className="flex items-center mb-2 sm:mb-0">  
                <Timer size={24} className="text-[#005b96] mr-2" />  
                <div className="text-2xl font-bold text-[#005b96]">  
                  {formatTime(remainingTime)}  
                </div>  
              </div>  
              
              {hintTimePenalty > 0 && (  
                <div className="flex items-center text-[#ff9900]">  
                  <AlertTriangle size={20} className="mr-1" />  
                  <span>Zeitstrafe f√ºr Hinweise: -{Math.floor(hintTimePenalty/60)} Minuten</span>  
                </div>  
              )}  
            </div>  
          </div>  

          {/* Main content */}  
          <div className="max-w-5xl mx-auto">  
            {/* Congratulations message */}  
            {showCongrats ? (  
              <div className="bg-gradient-to-r from-[#005b96] to-[#6497b1] text-white rounded-lg shadow-lg p-8 mb-6 text-center">  
                <h2 className="text-3xl font-bold mb-4">Herzlichen Gl√ºckwunsch!</h2>  
                <p className="text-xl mb-6">  
                  Ihr habt alle R√§tsel gel√∂st und Professor Kelvinius' Entdeckung gerettet!  
                </p>  
                <div className="flex justify-center">  
                  <button  
                    onClick={() => {  
                      setShowCongrats(false);  
                      handleResetTimer();  
                      setActiveRiddle(1);  
                      setInputCode("");  
                      setResultMessage("");  
                      setIsSuccess(false);  
                      setShowHint(false);  
                    }}  
                    className="px-6 py-3 bg-white text-[#005b96] rounded-full hover:bg-[#e1e9f0] font-semibold"  
                  >  
                    Neues Spiel starten  
                  </button>  
                </div>  
              </div>  
            ) : (  
              <>  
                {/* Riddle selector */}  
                <div className="bg-white rounded-lg shadow-lg p-6 mb-6">  
                  <h2 className="text-xl font-semibold text-[#005b96] mb-4">W√§hle das R√§tsel</h2>  
                  
                  <div className="grid grid-cols-1 sm:grid-cols-5 gap-2">  
                    {Object.keys(solutions).map(riddleNum => {  
                      const riddleNumber = parseInt(riddleNum);  
                      return (  
                        <button  
                          key={riddleNumber}  
                          onClick={() => {  
                            setActiveRiddle(riddleNumber);  
                            setInputCode("");  
                            setResultMessage("");  
                            setIsSuccess(false);  
                            setShowHint(false);  
                          }}  
                          className={`p-3 rounded-lg flex items-center justify-center ${  
                            activeRiddle === riddleNumber  
                              ? "bg-[#005b96] text-white"  
                              : "bg-[#f0f4f8] text-[#333333] hover:bg-[#b3cde0]"  
                          }`}  
                        >  
                          <Lock size={16} className="mr-2" />  
                          R√§tsel {riddleNumber}  
                        </button>  
                      );  
                    })}  
                  </div>  
                </div>  

                {/* Code validation area */}  
                <div className="bg-white rounded-lg shadow-lg p-6 mb-6">  
                  <div className="flex flex-col sm:flex-row justify-between items-start mb-4">  
                    <h1 className="text-2xl font-bold text-[#005b96] mb-2 sm:mb-0">  
                      R√§tsel {activeRiddle}: {solutions[activeRiddle].name}  
                    </h1>  
                    
                    <button  
                      onClick={toggleHint}  
                      className="flex items-center px-4 py-2 bg-[#ff9900] text-white rounded-md hover:bg-[#e68a00]"  
                    >  
                      <Lightbulb size={18} className="mr-2" />  
                      {showHint ? "Hinweis ausblenden" : "Hinweis anzeigen (-5 Min)"}  
                    </button>  
                  </div>  

                  {showHint && (  
                    <div className="bg-[#fff9e6] border-l-4 border-[#ff9900] p-4 mb-4">  
                      <p className="text-[#333333]">{solutions[activeRiddle].hint}</p>  
                    </div>  
                  )}  

                  <div className="mb-6">  
                    <label  
                      htmlFor="code-input"  
                      className="block text-[#333333] font-medium mb-2"  
                    >  
                      Gib deinen Code ein:  
                    </label>  
                    <div className="flex">  
                      <input  
                        id="code-input"  
                        type="text"  
                        value={inputCode}  
                        onChange={e => setInputCode(e.target.value)}  
                        placeholder="Code oder L√∂sungswort eingeben..."  
                        className="flex-grow px-4 py-3 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-[#005b96]"  
                      />  
                      <button  
                        onClick={validateCode}  
                        className="px-6 py-3 bg-[#005b96] text-white rounded-r-md hover:bg-[#003b66] flex items-center"  
                      >  
                        Pr√ºfen  
                        <ArrowRight size={18} className="ml-2" />  
                      </button>  
                    </div>  
                  </div>  

                  {resultMessage && (  
                    <div  
                      className={`p-4 mb-4 rounded-md ${  
                        isSuccess  
                          ? "bg-[#e6f7ef] border-l-4 border-[#0d8a47]"  
                          : "bg-[#ffeded] border-l-4 border-[#CC0000]"  
                      }`}  
                    >  
                      <div className="flex items-start">  
                        {isSuccess ? (  
                          <CheckCircle size={24} className="text-[#0d8a47] mr-3 mt-0.5" />  
                        ) : (  
                          <XCircle size={24} className="text-[#CC0000] mr-3 mt-0.5" />  
                        )}  
                        <p className={isSuccess ? "text-[#0d8a47]" : "text-[#CC0000]"}>  
                          {resultMessage}  
                        </p>  
                      </div>  
                    </div>  
                  )}  

                  <div className="flex justify-between mt-6">  
                    <button  
                      onClick={handlePreviousRiddle}  
                      disabled={activeRiddle === 1}  
                      className="px-4 py-2 bg-[#6497b1] text-white rounded-md hover:bg-[#4477a1] disabled:opacity-50"  
                    >  
                      Vorheriges R√§tsel  
                    </button>  
                    
                    {isSuccess && (  
                      <button  
                        onClick={handleNextRiddle}  
                        disabled={activeRiddle === Object.keys(solutions).length}  
                        className="px-4 py-2 bg-[#0d8a47] text-white rounded-md hover:bg-[#0a6e38] disabled:opacity-50"  
                      >  
                        N√§chstes R√§tsel  
                      </button>  
                    )}  
                  </div>  
                </div>  

                {/* Professor's Notes */}  
                <div className="bg-[#fffbf0] rounded-lg shadow-lg p-6 border-l-4 border-[#005b96]">  
                  <div className="flex items-start">  
                    <PenTool size={24} className="text-[#005b96] mr-3 mt-1" />  
                    <div>  
                      <h3 className="text-lg font-semibold text-[#005b96] mb-2">  
                        Notiz von Professor Kelvinius  
                      </h3>  
                      <p className="text-[#333333] italic">  
                        "Meine lieben Studierenden, denkt daran: In der Physik geht es nicht nur um Formeln und Zahlen, sondern um das Verst√§ndnis der grundlegenden Prinzipien. Die Codes, die ihr findet, sind nicht zuf√§llig - sie enthalten wichtige Erkenntnisse √ºber die Natur der Thermodynamik. Nutzt euer Wissen weise, denn die Zeit wird knapp!"  
                      </p>  
                    </div>  
                  </div>  
                </div>  
              </>  
            )}  
          </div>  
          
          {/* Footer */}  
          <div className="max-w-5xl mx-auto mt-8 text-center text-sm text-gray-600">  
            <p>¬© 2025 Professor Kelvinius' Thermodynamik-Escape-Room</p>  
          </div>  
        </div>  
      );  
    }  

    // Render die Komponente in das root-Element  
    ReactDOM.render(<EscapeRoomValidator />, document.getElementById('root'));  
  </script>  
</body>  
</html>